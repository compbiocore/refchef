
.. refchef index file, created by `ablog start` on Thu May 17 10:44:53 2018.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Brown CBC's RefChef Usage Guide
================================

At present, this documentation exists to describe the software in its current state to aid in the development process.  It will therefore usually lag one version behind the software itself, so some of the information presented herein may be incorrect/outdated.

For a more hands-on introduction to this software via walkthrough with code and sample files, please see the 'Sample Workflow / Walkthrough' page linked in the sidebar and on the homepage.

Master YAML / New YAML Scheme Overview
---------------------------------------

In the broadest possible sense, this tool can accommodate either one or two YAMLs.  It must always be given a 'Master YAML' - that is to say, a comprehensive list of references and their associated commands and metadata.  The Master YAML (hereafter simply 'the Master') is, essentially, a manifest of all references on the entire system (meant to be continually updated when further references are added).  The tool can also be given a 'New YAML' alongside the Master containing additional references.  Both of these files have the same formatting, but a New YAML corresponds to references that are being newly added to a system where some references are already present as tabulated in the Master.  Providing both the Master and a New YAML causes the New YAML's reference section to be appended to Master, ensuring the manifest remains comprehensive.

YAML Structure
--------------

Please see the following screenshot for an example YAML file, then refer to the description below the image for an explanation of its properties.

.. raw:: html

	<p>example.yaml</p>
    <img src="https://compbiocore.github.io/parseyaml/_static/refactored_yaml_screenshot.png">

There are several important features of this file structure that should be noted.

Top-Level Subheadings
~~~~~~~~~~~~~~~~~~~~~

First is the 'configuration' subheading; this group of settings controls various options within the program.  Here, you can see three such options, with more to be added in the future.  The first is 'root-directory', which designates which folder the software will operate in.  The second is 'break-on-error', which causes the utility to break upon encountering an error rather than continuing onto other references.  The third is 'verbose', which controls the level of console output generated by the tool.

Second are the reference subheadings, which will constitute the vast majority of the YAML.  These subheading constitute all of the references documented within the YAML.  We will describe the contents of one such subheading's structure from the image - the most complicated one, 'ucsc-hg19-concatenate'.

**Per-Reference Subheadings**

Within 'ucsc-hg19-concatenate', there are several subheadings.  One of these, 'metadata', is required for all references.  The others, which can have any name and be as numerous as is needed, each describe one type of feature for a specified reference.  If that appears confusing at first glance, please continue reading.

The 'metadata' subheading includes important pieces of metadata that the user must record for a given reference.  'reference-name' is a field that is used to name the directory created by the software for that reference's files (which can be the same as, or different than, the respective yaml key), while the rest are merely recorded.  At this time, three such pieces of metadata are supported: 'species', denoting the organism's species; 'organization', indicating which organization created the reference; and 'downloader', indicating which user ran the software on this reference.  In addition to being tabulated in the YAML, this metadata is written to a file and included with the reference files.

The other subheadings each include two subheadings of their own: 'retrieve', which tells the program whether or not to run the associated commands, and 'command-sequence', which lists out all of the commands involved in the download and processing of the reference component.  In the depicted example, 'ucsc-hg19-concatenate', the UCSC version of hg19, has two components: the genome fasta ('primary-reference') and a list of ESTs assocated with that version of the genome ('est').